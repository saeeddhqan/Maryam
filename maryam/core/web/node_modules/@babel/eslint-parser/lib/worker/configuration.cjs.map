{"version":3,"names":["babel","require","ESLINT_VERSION","getParserPlugins","babelOptions","babelParserPlugins","parserOpts","plugins","estreeOptions","classFeatures","plugin","Array","isArray","Object","assign","normalizeParserOptions","options","sourceType","filename","filePath","allowImportExportEverywhere","allowSuperOutsideMethod","allowReturnOutsideFunction","ecmaFeatures","globalReturn","attachComment","ranges","tokens","caller","name","validateResolvedConfig","config","parseOptions","requireConfigFile","hasFilesystemConfig","error","includes","Error","getDefaultParserOptions","babelrc","configFile","browserslistConfigFile","ignore","only","exports","normalizeBabelParseConfig","loadPartialConfigAsync","normalizeBabelParseConfigSync","loadPartialConfigSync"],"sources":["../../src/worker/configuration.cjs"],"sourcesContent":["const babel = require(\"./babel-core.cjs\");\nconst ESLINT_VERSION = require(\"../utils/eslint-version.cjs\");\n\n/**\n * Merge user supplied estree plugin options to default estree plugin options\n *\n * @param {*} babelOptions\n * @returns {Array} Merged parser plugin descriptors\n */\nfunction getParserPlugins(babelOptions) {\n  const babelParserPlugins = babelOptions.parserOpts?.plugins ?? [];\n  const estreeOptions = { classFeatures: ESLINT_VERSION >= 8 };\n  for (const plugin of babelParserPlugins) {\n    if (Array.isArray(plugin) && plugin[0] === \"estree\") {\n      Object.assign(estreeOptions, plugin[1]);\n      break;\n    }\n  }\n  // estree must be the first parser plugin to work with other parser plugins\n  return [[\"estree\", estreeOptions], ...babelParserPlugins];\n}\n\nfunction normalizeParserOptions(options) {\n  return {\n    sourceType: options.sourceType,\n    filename: options.filePath,\n    ...options.babelOptions,\n    parserOpts: {\n      ...(process.env.BABEL_8_BREAKING\n        ? {}\n        : {\n            allowImportExportEverywhere:\n              options.allowImportExportEverywhere ?? false,\n            allowSuperOutsideMethod: true,\n          }),\n      allowReturnOutsideFunction:\n        options.ecmaFeatures?.globalReturn ??\n        (process.env.BABEL_8_BREAKING ? false : true),\n      ...options.babelOptions.parserOpts,\n      plugins: getParserPlugins(options.babelOptions),\n      // skip comment attaching for parsing performance\n      attachComment: false,\n      ranges: true,\n      tokens: true,\n    },\n    caller: {\n      name: \"@babel/eslint-parser\",\n      ...options.babelOptions.caller,\n    },\n  };\n}\n\nfunction validateResolvedConfig(config, options, parseOptions) {\n  if (config !== null) {\n    if (options.requireConfigFile !== false) {\n      if (!config.hasFilesystemConfig()) {\n        let error = `No Babel config file detected for ${config.options.filename}. Either disable config file checking with requireConfigFile: false, or configure Babel so that it can find the config files.`;\n\n        if (config.options.filename.includes(\"node_modules\")) {\n          error += `\\nIf you have a .babelrc.js file or use package.json#babel, keep in mind that it's not used when parsing dependencies. If you want your config to be applied to your whole app, consider using babel.config.js or babel.config.json instead.`;\n        }\n\n        throw new Error(error);\n      }\n    }\n    if (config.options) return config.options;\n  }\n\n  return getDefaultParserOptions(parseOptions);\n}\n\nfunction getDefaultParserOptions(options) {\n  return {\n    plugins: [],\n    ...options,\n    babelrc: false,\n    configFile: false,\n    browserslistConfigFile: false,\n    ignore: null,\n    only: null,\n  };\n}\n\nexports.normalizeBabelParseConfig = async function (options) {\n  const parseOptions = normalizeParserOptions(options);\n  const config = await babel.loadPartialConfigAsync(parseOptions);\n  return validateResolvedConfig(config, options, parseOptions);\n};\n\nexports.normalizeBabelParseConfigSync = function (options) {\n  const parseOptions = normalizeParserOptions(options);\n  const config = babel.loadPartialConfigSync(parseOptions);\n  return validateResolvedConfig(config, options, parseOptions);\n};\n"],"mappings":";;;;AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,kBAAD,CAArB;;AACA,MAAMC,cAAc,GAAGD,OAAO,CAAC,6BAAD,CAA9B;;AAQA,SAASE,gBAAT,CAA0BC,YAA1B,EAAwC;EAAA;;EACtC,MAAMC,kBAAkB,sDAAGD,YAAY,CAACE,UAAhB,qBAAG,uBAAyBC,OAA5B,oCAAuC,EAA/D;EACA,MAAMC,aAAa,GAAG;IAAEC,aAAa,EAAEP,cAAc,IAAI;EAAnC,CAAtB;;EACA,KAAK,MAAMQ,MAAX,IAAqBL,kBAArB,EAAyC;IACvC,IAAIM,KAAK,CAACC,OAAN,CAAcF,MAAd,KAAyBA,MAAM,CAAC,CAAD,CAAN,KAAc,QAA3C,EAAqD;MACnDG,MAAM,CAACC,MAAP,CAAcN,aAAd,EAA6BE,MAAM,CAAC,CAAD,CAAnC;MACA;IACD;EACF;;EAED,OAAO,CAAC,CAAC,QAAD,EAAWF,aAAX,CAAD,EAA4B,GAAGH,kBAA/B,CAAP;AACD;;AAED,SAASU,sBAAT,CAAgCC,OAAhC,EAAyC;EAAA;;EACvC;IACEC,UAAU,EAAED,OAAO,CAACC,UADtB;IAEEC,QAAQ,EAAEF,OAAO,CAACG;EAFpB,GAGKH,OAAO,CAACZ,YAHb;IAIEE,UAAU,oBAGJ;MACEc,2BAA2B,2BACzBJ,OAAO,CAACI,2BADiB,oCACc,KAF3C;MAGEC,uBAAuB,EAAE;IAH3B,CAHI;MAQRC,0BAA0B,qDACxBN,OAAO,CAACO,YADgB,qBACxB,uBAAsBC,YADE,oCAEgB;IAVlC,GAWLR,OAAO,CAACZ,YAAR,CAAqBE,UAXhB;MAYRC,OAAO,EAAEJ,gBAAgB,CAACa,OAAO,CAACZ,YAAT,CAZjB;MAcRqB,aAAa,EAAE,KAdP;MAeRC,MAAM,EAAE,IAfA;MAgBRC,MAAM,EAAE;IAhBA,EAJZ;IAsBEC,MAAM;MACJC,IAAI,EAAE;IADF,GAEDb,OAAO,CAACZ,YAAR,CAAqBwB,MAFpB;EAtBR;AA2BD;;AAED,SAASE,sBAAT,CAAgCC,MAAhC,EAAwCf,OAAxC,EAAiDgB,YAAjD,EAA+D;EAC7D,IAAID,MAAM,KAAK,IAAf,EAAqB;IACnB,IAAIf,OAAO,CAACiB,iBAAR,KAA8B,KAAlC,EAAyC;MACvC,IAAI,CAACF,MAAM,CAACG,mBAAP,EAAL,EAAmC;QACjC,IAAIC,KAAK,GAAI,qCAAoCJ,MAAM,CAACf,OAAP,CAAeE,QAAS,+HAAzE;;QAEA,IAAIa,MAAM,CAACf,OAAP,CAAeE,QAAf,CAAwBkB,QAAxB,CAAiC,cAAjC,CAAJ,EAAsD;UACpDD,KAAK,IAAK,8OAAV;QACD;;QAED,MAAM,IAAIE,KAAJ,CAAUF,KAAV,CAAN;MACD;IACF;;IACD,IAAIJ,MAAM,CAACf,OAAX,EAAoB,OAAOe,MAAM,CAACf,OAAd;EACrB;;EAED,OAAOsB,uBAAuB,CAACN,YAAD,CAA9B;AACD;;AAED,SAASM,uBAAT,CAAiCtB,OAAjC,EAA0C;EACxC;IACET,OAAO,EAAE;EADX,GAEKS,OAFL;IAGEuB,OAAO,EAAE,KAHX;IAIEC,UAAU,EAAE,KAJd;IAKEC,sBAAsB,EAAE,KAL1B;IAMEC,MAAM,EAAE,IANV;IAOEC,IAAI,EAAE;EAPR;AASD;;AAEDC,OAAO,CAACC,yBAAR,qBAAoC,WAAgB7B,OAAhB,EAAyB;EAC3D,MAAMgB,YAAY,GAAGjB,sBAAsB,CAACC,OAAD,CAA3C;EACA,MAAMe,MAAM,SAAS/B,KAAK,CAAC8C,sBAAN,CAA6Bd,YAA7B,CAArB;EACA,OAAOF,sBAAsB,CAACC,MAAD,EAASf,OAAT,EAAkBgB,YAAlB,CAA7B;AACD,CAJD;;AAMAY,OAAO,CAACG,6BAAR,GAAwC,UAAU/B,OAAV,EAAmB;EACzD,MAAMgB,YAAY,GAAGjB,sBAAsB,CAACC,OAAD,CAA3C;EACA,MAAMe,MAAM,GAAG/B,KAAK,CAACgD,qBAAN,CAA4BhB,YAA5B,CAAf;EACA,OAAOF,sBAAsB,CAACC,MAAD,EAASf,OAAT,EAAkBgB,YAAlB,CAA7B;AACD,CAJD"}