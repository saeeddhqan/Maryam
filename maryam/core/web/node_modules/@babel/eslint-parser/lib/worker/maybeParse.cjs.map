{"version":3,"names":["babel","require","convert","getVisitorKeys","getTokLabels","extractParserOptionsPlugin","ref","extractParserOptionsConfigItem","MULTIPLE_OVERRIDES","module","exports","maybeParse","code","options","createConfigItem","dirname","__dirname","type","plugins","concat","parserOptions","parseSync","ast","err","test","message","error"],"sources":["../../src/worker/maybeParse.cjs"],"sourcesContent":["const babel = require(\"./babel-core.cjs\");\nconst convert = require(\"../convert/index.cjs\");\nconst { getVisitorKeys, getTokLabels } = require(\"./ast-info.cjs\");\nconst extractParserOptionsPlugin = require(\"./extract-parser-options-plugin.cjs\");\n\nconst ref = {};\nlet extractParserOptionsConfigItem;\n\nconst MULTIPLE_OVERRIDES = /More than one plugin attempted to override parsing/;\n\nmodule.exports = function maybeParse(code, options) {\n  if (!extractParserOptionsConfigItem) {\n    extractParserOptionsConfigItem = babel.createConfigItem(\n      [extractParserOptionsPlugin, ref],\n      { dirname: __dirname, type: \"plugin\" },\n    );\n  }\n  const { plugins } = options;\n  options.plugins = plugins.concat(extractParserOptionsConfigItem);\n\n  try {\n    return {\n      parserOptions: babel.parseSync(code, options),\n      ast: null,\n    };\n  } catch (err) {\n    if (!MULTIPLE_OVERRIDES.test(err.message)) {\n      throw err;\n    }\n  }\n\n  // There was already a parserOverride, so remove our plugin.\n  options.plugins = plugins;\n\n  let ast;\n  try {\n    ast = babel.parseSync(code, options);\n  } catch (err) {\n    throw convert.error(err);\n  }\n\n  return {\n    ast: convert.ast(ast, code, getTokLabels(), getVisitorKeys()),\n    parserOptions: null,\n  };\n};\n"],"mappings":"AAAA,MAAMA,KAAK,GAAGC,OAAO,CAAC,kBAAD,CAArB;;AACA,MAAMC,OAAO,GAAGD,OAAO,CAAC,sBAAD,CAAvB;;AACA,MAAM;EAAEE,cAAF;EAAkBC;AAAlB,IAAmCH,OAAO,CAAC,gBAAD,CAAhD;;AACA,MAAMI,0BAA0B,GAAGJ,OAAO,CAAC,qCAAD,CAA1C;;AAEA,MAAMK,GAAG,GAAG,EAAZ;AACA,IAAIC,8BAAJ;AAEA,MAAMC,kBAAkB,GAAG,oDAA3B;;AAEAC,MAAM,CAACC,OAAP,GAAiB,SAASC,UAAT,CAAoBC,IAApB,EAA0BC,OAA1B,EAAmC;EAClD,IAAI,CAACN,8BAAL,EAAqC;IACnCA,8BAA8B,GAAGP,KAAK,CAACc,gBAAN,CAC/B,CAACT,0BAAD,EAA6BC,GAA7B,CAD+B,EAE/B;MAAES,OAAO,EAAEC,SAAX;MAAsBC,IAAI,EAAE;IAA5B,CAF+B,CAAjC;EAID;;EACD,MAAM;IAAEC;EAAF,IAAcL,OAApB;EACAA,OAAO,CAACK,OAAR,GAAkBA,OAAO,CAACC,MAAR,CAAeZ,8BAAf,CAAlB;;EAEA,IAAI;IACF,OAAO;MACLa,aAAa,EAAEpB,KAAK,CAACqB,SAAN,CAAgBT,IAAhB,EAAsBC,OAAtB,CADV;MAELS,GAAG,EAAE;IAFA,CAAP;EAID,CALD,CAKE,OAAOC,GAAP,EAAY;IACZ,IAAI,CAACf,kBAAkB,CAACgB,IAAnB,CAAwBD,GAAG,CAACE,OAA5B,CAAL,EAA2C;MACzC,MAAMF,GAAN;IACD;EACF;;EAGDV,OAAO,CAACK,OAAR,GAAkBA,OAAlB;EAEA,IAAII,GAAJ;;EACA,IAAI;IACFA,GAAG,GAAGtB,KAAK,CAACqB,SAAN,CAAgBT,IAAhB,EAAsBC,OAAtB,CAAN;EACD,CAFD,CAEE,OAAOU,GAAP,EAAY;IACZ,MAAMrB,OAAO,CAACwB,KAAR,CAAcH,GAAd,CAAN;EACD;;EAED,OAAO;IACLD,GAAG,EAAEpB,OAAO,CAACoB,GAAR,CAAYA,GAAZ,EAAiBV,IAAjB,EAAuBR,YAAY,EAAnC,EAAuCD,cAAc,EAArD,CADA;IAELiB,aAAa,EAAE;EAFV,CAAP;AAID,CAnCD"}